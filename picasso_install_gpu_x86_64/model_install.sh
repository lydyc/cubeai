#!/bin/bash
export LD_LIBRARY_PATH=`pwd`/lib

# 标签文件从安装目录model文件夹下拷贝至系统目录/data/share/data路径下
mkdir -p /data/share/data/
cp -r ./model/labels /data/share/data

# libnvrtc-builtins.so -> libnvrtc-builtins.so.10.2
cd lib
if [ ! -f "libnvrtc-builtins.so.11.8" ];then
    echo "nvrtc-builtins library does not exist"
    exit 0
else
    ln -sf libnvrtc-builtins.so.11.8 libnvrtc-builtins.so
fi

if [ ! -f "libcublasLt.so.11" ];then
    echo "libcublasLt library does not exist"
    exit 0
else
    ln -sf libcublasLt.so.11 libcublasLt.so
fi

cd ..

# m模型安装
python ./tool/model_helper.py -o update_model_file -s "ENABLE_COMMON:ENABLE_DOSING:ENABLE_ENGINE_VEHICLE:ENABLE_FACE:ENABLE_LITE_FACE:ENABLE_FACE_INFRARED:ENABLE_LITE_FACE_INFRARED:ENABLE_PERSON:ENABLE_VEHICLE:ENABLE_NON_VEHICLE:ENABLE_RIDER:ENABLE_DRIVER:ENABLE_VEHICLE_DISTANCE:ENABLE_LANE_MARK:ENABLE_PT_FEATURE:ENABLE_PT_FEATURE_EXTRACT:ENABLE_FFMPEG_GPU:ENABLE_STREET_VIOLATE:ENABLE_MUCK_TRUCK:ENABLE_MUCK_TRUCK_PLATE:ENABLE_SAFETY_WEAR:ENABLE_SAFETY_WEAR_ATTR:ENABLE_SMOKE_CALL:ENABLE_SMOKE_CALL_ATTR:ENABLE_ANIMAL:ENABLE_SMOKE_FIRE:ENABLE_BCP_MUD:ENABLE_COARSE_GRID:ENABLE_SIPHON:ENABLE_GRID_SLAG:ENABLE_SED_MUD:ENABLE_TUBE_MUD:ENABLE_CHAN_OCCU:ENABLE_METER:ENABLE_VEHICLE_PLATE:ENABLE_PONDING:ENABLE_WATER_LEVEL:ENABLE_DRIVER_SHELTER:ENABLE_SPECIAL_VEHICLE:ENABLE_SWITCH:ENABLE_SHIP:ENABLE_FLOATAGE:ENABLE_BREAKER:ENABLE_ANTIEPIDEMIC_VIOLATE:ENABLE_ARRESTER_METER:ENABLE_OCR:ENABLE_IDENTIFICATION:ENABLE_DRIVING_LICENSE:ENABLE_NUMBER:ENABLE_ACTION:ENABLE_MOUSE:ENABLE_CAT_DOG:ENABLE_YABAN:ENABLE_ROTATE_HANDLE:ENABLE_INDICATOR:ENABLE_PROTECTIVE_SUIT:ENABLE_PLATE_POLLUTE:ENABLE_HUXIQI_COLOR_ABNORMAL:ENABLE_HUXIQI_RATIO:ENABLE_HUXIQI_OIL:ENABLE_THROW_OBJECT:ENABLE_HUXIQI_BREAK:ENABLE_LOESS_UNCOVERED:ENABLE_PERSON_SLEEP_DETECT:ENABLE_HUOTI_FACE:ENABLE_SCREEN_DETE:ENABLE_LOSE_LEGACY:ENABLE_STEEL_DEFECT:ENABLE_DRINK_WATER:ENABLE_DRINK_WATER_DETECT:ENABLE_WATER_STAIN:ENABLE_FIRE_EXTINGUISHER_DETECT:ENABLE_HEAD:ENABLE_COMPUTER_ROOM_DETE:ENABLE_UAV_PERSON_VEHICLE_DETE:ENABLE_TRANS_STATION_PATROL:ENABLE_PEOPLE_POSE_DETECT:ENABLE_SAFETY_WEAR_ELECTRIC:ENABLE_RGB_IR_PERSON:ENABLE_HELMET:ENABLE_SAFETY_BELT:ENABLE_CARTON_DETE:ENABLE_FALL_DOWN:ENABLE_SALIENCY:ENABLE_CARRY_ITEMS:ENABLE_CABLE_MESSY:ENABLE_GROUND_SANITATION:ENABLE_INDICATOR_DETECT:ENABLE_CHINA_MOBILE_ASSET_TAG:ENABLE_BLIND_PLATE_LOSS_DETECT:ENABLE_TINY_PERSON_DETE:ENABLE_SMOKE_FIRE_ENHANCEMENT:ENABLE_CHEF_WHITE_DETE:ENABLE_CLOSE_INDICATOR_DETECT:ENABLE_PERSON_CLIMB_DETECT:ENABLE_FLOOR_COLLAPSE_DETECT"
python ./tool/model_helper.py -o install -s "ENABLE_COMMON:ENABLE_DOSING:ENABLE_ENGINE_VEHICLE:ENABLE_FACE:ENABLE_LITE_FACE:ENABLE_FACE_INFRARED:ENABLE_LITE_FACE_INFRARED:ENABLE_PERSON:ENABLE_VEHICLE:ENABLE_NON_VEHICLE:ENABLE_RIDER:ENABLE_DRIVER:ENABLE_VEHICLE_DISTANCE:ENABLE_LANE_MARK:ENABLE_PT_FEATURE:ENABLE_PT_FEATURE_EXTRACT:ENABLE_FFMPEG_GPU:ENABLE_STREET_VIOLATE:ENABLE_MUCK_TRUCK:ENABLE_MUCK_TRUCK_PLATE:ENABLE_SAFETY_WEAR:ENABLE_SAFETY_WEAR_ATTR:ENABLE_SMOKE_CALL:ENABLE_SMOKE_CALL_ATTR:ENABLE_ANIMAL:ENABLE_SMOKE_FIRE:ENABLE_BCP_MUD:ENABLE_COARSE_GRID:ENABLE_SIPHON:ENABLE_GRID_SLAG:ENABLE_SED_MUD:ENABLE_TUBE_MUD:ENABLE_CHAN_OCCU:ENABLE_METER:ENABLE_VEHICLE_PLATE:ENABLE_PONDING:ENABLE_WATER_LEVEL:ENABLE_DRIVER_SHELTER:ENABLE_SPECIAL_VEHICLE:ENABLE_SWITCH:ENABLE_SHIP:ENABLE_FLOATAGE:ENABLE_BREAKER:ENABLE_ANTIEPIDEMIC_VIOLATE:ENABLE_ARRESTER_METER:ENABLE_OCR:ENABLE_IDENTIFICATION:ENABLE_DRIVING_LICENSE:ENABLE_NUMBER:ENABLE_ACTION:ENABLE_MOUSE:ENABLE_CAT_DOG:ENABLE_YABAN:ENABLE_ROTATE_HANDLE:ENABLE_INDICATOR:ENABLE_PROTECTIVE_SUIT:ENABLE_PLATE_POLLUTE:ENABLE_HUXIQI_COLOR_ABNORMAL:ENABLE_HUXIQI_RATIO:ENABLE_HUXIQI_OIL:ENABLE_THROW_OBJECT:ENABLE_HUXIQI_BREAK:ENABLE_LOESS_UNCOVERED:ENABLE_PERSON_SLEEP_DETECT:ENABLE_HUOTI_FACE:ENABLE_SCREEN_DETE:ENABLE_LOSE_LEGACY:ENABLE_STEEL_DEFECT:ENABLE_DRINK_WATER:ENABLE_DRINK_WATER_DETECT:ENABLE_WATER_STAIN:ENABLE_FIRE_EXTINGUISHER_DETECT:ENABLE_HEAD:ENABLE_COMPUTER_ROOM_DETE:ENABLE_UAV_PERSON_VEHICLE_DETE:ENABLE_TRANS_STATION_PATROL:ENABLE_PEOPLE_POSE_DETECT:ENABLE_SAFETY_WEAR_ELECTRIC:ENABLE_RGB_IR_PERSON:ENABLE_HELMET:ENABLE_SAFETY_BELT:ENABLE_CARTON_DETE:ENABLE_FALL_DOWN:ENABLE_SALIENCY:ENABLE_CARRY_ITEMS:ENABLE_CABLE_MESSY:ENABLE_GROUND_SANITATION:ENABLE_INDICATOR_DETECT:ENABLE_CHINA_MOBILE_ASSET_TAG:ENABLE_BLIND_PLATE_LOSS_DETECT:ENABLE_TINY_PERSON_DETE:ENABLE_SMOKE_FIRE_ENHANCEMENT:ENABLE_CHEF_WHITE_DETE:ENABLE_CLOSE_INDICATOR_DETECT:ENABLE_PERSON_CLIMB_DETECT:ENABLE_FLOOR_COLLAPSE_DETECT"
